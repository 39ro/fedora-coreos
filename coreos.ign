{
  "ignition": {
    "version": "3.5.0"
  },
  "passwd": {
    "users": [
      {
        "groups": [
          "wheel"
        ],
        "name": "core",
        "sshAuthorizedKeys": [
          "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDixgmi6yxyYmkok37WUtOr6x1R2kGcsUsST5ewC7Xjh nousername"
        ]
      }
    ]
  },
  "storage": {
    "files": [
      {
        "path": "/etc/hostname",
        "contents": {
          "compression": "",
          "source": "data:,k8s-node"
        },
        "mode": 420
      },
      {
        "path": "/etc/yum.repos.d/kubernetes.repo",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/5TMOwoCMRRG4T6LyWXQQgJZgUsQizx+MnLzIjcjzu5FBfvpDl9xbrx5jIoJuavqCuz1D8o7wTayXefsYog6J9F8Ef1oFNqAIZnOZxh6Lvp0ptELKdQPRbuo1FNYEfiXjP3QaKC36Kb7Ron6VbJm7OodAAD//x8ErPCyAAAA"
        },
        "mode": 420
      },
      {
        "path": "/etc/yum.repos.d/cri-o.repo",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/6zNParDMBAE4F53sRbzXiVwlSpVIG1IsbYWW+hnxa7sxLcPdq6Q7mMYZh6ThI6fpmCm4XK/djczotIqaVhaq+oAPL9KYvSWKxVdlSzLDEKVNTSWQApBNwfnkgNtOCZysPX27x+kZjBUjsgPvZnrPC00xS8j7b97OaoeG57I3r5zspF28wkAAP//+6g6auIAAAA="
        },
        "mode": 420
      },
      {
        "path": "/etc/modules-load.d/k8s.conf",
        "contents": {
          "compression": "",
          "source": "data:,overlay%0Abr_netfilter%0A"
        },
        "mode": 420
      },
      {
        "path": "/etc/sysctl.d/k8s.conf",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/8pLLdFLKspMSU+FUrp5abrJiTk5upkFZiWJSTmpxQq2CoZc+NShKcssKDPRyyyIT8svKk8sSgGLAwIAAP//5C49v2cAAAA="
        },
        "mode": 420
      },
      {
        "path": "/etc/crio/crio.conf.d/01-cni.conf",
        "contents": {
          "compression": "",
          "source": "data:;base64,W2NyaW8ubmV0d29ya10KcGx1Z2luX2RpcnMgPSBbCiAgIi9vcHQvY25pL2Jpbi8iLAogICIvdXNyL2xpYmV4ZWMvY25pIgpdCg=="
        },
        "mode": 420
      },
      {
        "path": "/etc/kubernetes/kubeadm-config.yaml",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/6yRMWvkMBCFe/0K4d6SfWeOw13YTRFCIOxCetmeNYPlGTOSnM2/D5aXQLZKkUag4eO9efPcgm8gAZlaPaUOPETTM11wNNP/YJDtWncQXa0mpKHVzztzyEgSF5FJrezTDK8+jUhHlFYXdnViPXb2pml3ZMlIKFQ/CqflKLjChoePEGEeCtUzRYcEckoUcYZHGhZGiq0uEuG1tTYrSyLbC3J+TOB+KlRZluo+jRvm7zGaW4wnwrsMxAOcYMQQ90GrtO4Fz9xP8Ov2B59CBLnbAOI7y4Q0bt4LD+fUUfauK/OnaUxlKlv/K9QmLQQRwpdbbf42psrnE/Ye5MWRG0E2JbhGcQ8yhu2jdanJzdDqi4druddS7r2UA0pGtF6dT/CDHj8DAAD//3+iCSc/AgAA"
        },
        "mode": 420
      },
      {
        "path": "/usr/local/bin/kubeadm-post-init.sh",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/3STQU/cMBCF7/4VD4IqUJuY5QgCqUWlWiFRLqiHqgdvPNmMcOzInrDw7ysngaZa7SWy43nPb76RiyO9Ya9TqxIJSlJUtwHHRVHgjj2nliyehw0Z24E9yxckEmG/xdCPB3XwDW9RFMWxUt2z5Yiyh25DR7oOkXSVq1TdQ5PUOm+iJ6Gkje3YV1m/V64nV1W3YeeR/1/mz8E6Ra99iIL7p2/fb38+3K1/XB++TakCvwwLmhAhLeHr4xqJ4gtFSMCGEMnYtwWJXJ1bzoL7D8uFrqqqiQBfn6tdy45wBD2kOMIdMYnDlgQ+WEq40ZZetB+cw8XNp9UVbFAAX5+cnvLn1dlZ3jT4jRNGuRWsLvDnKkf1CgCmYIvUli18ENShozwX0whFXKBjPwil40n1yoKVAhpWQHJEPVbnyga/HPrCldMEYm5NFXjyYtjLCK0OXmJwZe+Mp7GtDM84F3bog00zylS3ZAdHFsGDZXHTbJa57nt9AN2DOCWYMJalcW5clzE4qv6Nu+Kg/3Mtc/61T5IVjTPek8Ptw3oRaD4dBz0VHE5h+t69oWzQivTpUustSztsqjp0ehaXHN6XOpIjkyhpZ4SSaBt23gVjR7/y/ba3zqlFnseQpMxvDqmO3Aua+UHOof4GAAD//3Aqea67AwAA"
        },
        "mode": 493
      },
      {
        "path": "/home/core/.kube/config",
        "mode": 420
      }
    ]
  },
  "systemd": {
    "units": [
      {
        "contents": "[Unit]\nDescription=Install Kubernetes packages\nRequires=rpm-ostreed.service\nAfter=rpm-ostreed.service network-online.target\nWants=network-online.target\nConditionPathExists=!/var/lib/%N.stamp\n\n[Service]\nType=oneshot\nTimeoutStartSec=0\nExecStart=/usr/bin/rpm-ostree install cri-o kubelet kubeadm kubectl containernetworking-plugins\nExecStartPost=/usr/bin/touch /var/lib/%N.stamp\n\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "install-k8s.service"
      },
      {
        "enabled": true,
        "name": "crio.service"
      },
      {
        "enabled": true,
        "name": "kubelet.service"
      },
      {
        "enabled": true,
        "name": "qemu-guest-agent.service"
      },
      {
        "contents": "[Unit]\nDescription=Initialize Kubernetes cluster\nRequires=crio.service\nWants=kubelet.service\nAfter=crio.service kubelet.service\nConditionPathExists=!/etc/kubernetes/admin.conf\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/kubeadm init --config /etc/kubernetes/kubeadm-config.yaml --upload-certs\nExecStartPost=/usr/local/bin/kubeadm-post-init.sh\n\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "kubeadm-init.service"
      }
    ]
  }
}
